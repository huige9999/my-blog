
# 标题候选

1. **Claude Code 的项目记忆怎么组织：CLAUDE.md、Skills、docs 的分层实践**
2. **从混乱到可维护：我如何给 Agent 搭建“记忆系统”**
3. **别再把所有规则塞进 CLAUDE.md：一套更清晰的组织方式**

---

# 文章核心观点（一句话先亮出来）

> **把知识按“谁需要读（人/agent）+ 什么时候需要读（常驻/按需）+ 作用范围（全仓/模块/任务）”分层，剩下的只是文件放哪的问题。**

这句话就是你整篇博客的“指南针”。

---

# 文章结构（建议 6 节）

## 1. 痛点：我有一堆“该沉淀的东西”，但不知道该放哪

讲你真实遇到的混乱：

* 根 `CLAUDE.md` 放了太多，每次会话都加载，污染上下文
* 子目录 `CLAUDE.md` 什么时候会生效？会不会冲突？
* Skills 看起来像流程，但我也有 docs
* 同一件事（比如模块上下文）到底放 docs 还是写到 CLAUDE 里？

用一句“问题定义”收束：

> **我需要一个“项目记忆的文件系统”，让该常驻的常驻、该按需的按需、该给人看的给人看、该给 agent 执行的给 agent。**

---

## 2. 三个维度：任何沉淀内容都先做这 3 个分类

这节是最有价值的“方法论”。

### 维度 A：读者是谁？

* **Human-first**：给人看的（解释/背景/设计）
* **Agent-first**：给 agent 执行的（流程/检查/命令/验收）

### 维度 B：加载时机？

* **Always-on**：每次都需要（短规则/硬约束）
* **On-demand**：只有特定任务才要（写文章/发版/迁移）

### 维度 C：作用范围？

* **Repo-wide**：全仓通用
* **Module-scoped**：某个子目录/模块
* **Task-scoped**：一次性或少数任务

你可以配一个小表（文章里非常清晰）：

| 维度 | 选项          | 典型内容                |
| -- | ----------- | ------------------- |
| 读者 | Human-first | 模块上下文、设计 rationale  |
| 读者 | Agent-first | SOP、验收 checklist、命令 |
| 时机 | Always-on   | 硬约束、不变量             |
| 时机 | On-demand   | 写作/发布/迁移/回滚         |
| 范围 | Repo-wide   | 通用规则、工具链            |
| 范围 | Module      | 模块边界、入口、坑           |
| 范围 | Task        | 本次改动说明              |

---

## 3. 四类载体：CLAUDE.md / 子目录 CLAUDE.md / Skills / docs 各自负责什么

这是你要讲清楚的“四件东西”。

### 3.1 根 `CLAUDE.md`：仓库级硬规则（短而硬、常驻）

**定位**：Always-on + Agent-first + Repo-wide
放什么：

* 工具链（pnpm/poetry/make）
* 不变量（base 路径、约定、禁止项）
* 安全护栏（例如 destructive 操作必须先 `git status`）
  不放什么：
* 长篇背景解释
* 详细流程 SOP（会污染每次会话）

一句金句：

> 根 CLAUDE.md 像“项目宪法”，只写你愿意每次启动都背诵的内容。

### 3.2 子目录 `CLAUDE.md`：模块就地规则（局部覆盖、就近原则）

**定位**：Always-on + Agent-first + Module-scoped
放什么：

* 这个模块的约束、不变量、约定
* “改这里要同时改哪里”的联动点
* 这个模块专用命令/测试

一句金句：

> 子目录 CLAUDE.md 是“模块边境检查站”：进入这个目录工作就必须遵守。

### 3.3 Skills：按需加载的操作手册（任务开关）

**定位**：On-demand + Agent-first + Task-scoped（或特定领域 scoped）
放什么：

* 写文章/发布流程
* 发版流程、迁移流程、紧急回滚流程
* 任何你不希望每次加载、但希望一旦调用就严格执行的东西

一句金句：

> Skills 是“只在你喊它名字时才出现的专家”。

### 3.4 `docs/`：人类知识库（解释、背景、架构、长期沉淀）

**定位**：Human-first + On-demand（阅读）+ Repo/Module-wide
放什么：

* 模块上下文（入口、数据流、边界、坑）
* 架构决策（ADR）
* 设计说明、FAQ、Troubleshooting
* 开发记录（但建议结构化）

一句金句：

> docs 是给未来的人类（包括未来的你）看的；写得好能减少 80% 口头解释。

---

## 4. 你的四种内容：到底分别放哪？

这是读者最关心的“对号入座”。

### A）模块上下文沉淀（反复解释的那种）

✅ **优先放 docs/**
建议：`docs/modules/<module>.md`
结构模板：

* What/Why/Where/How
* Contracts（不变量、输入输出）
* Pitfalls（常见坑）
* Links（相关 ADR/PR）

同时可以在模块目录下放一个简短 `CLAUDE.md` 指向 docs：

> “先阅读 docs/modules/foo.md，再动手”

### B）开发记录沉淀（你做过什么、为什么这么改）

看你“记录”的目的：

* 如果是“可追溯的决策/理由”：放 `docs/decisions/`（ADR 风格）
* 如果是“每次改动的日志”：直接靠 Git PR/commit message 更合适
* 如果是“个人成长/复盘”：放博客或 `notes/`（但别塞进 CLAUDE）

一句结论：

> 开发记录要么进入“可被引用的决策文档（ADR）”，要么进入“版本历史（Git）”，不要混成一锅粥。

### C）某个固定流程沉淀（写文章/发布/回滚）

✅ **优先 Skills**
因为你明确说“只在做这类任务才加载”。

### D）规则约束沉淀（不变量/必须遵守）

* 全仓通用：根 `CLAUDE.md`
* 只对模块：子目录 `CLAUDE.md`
* 又长又细、但只在某任务：Skills（不要塞根 CLAUDE）

---

## 5. 我最终的目录结构（给一个可复制的推荐树）

这一节给出“我推荐你就这么搭”的目录树，极具落地性：

```
CLAUDE.md                       # 仓库宪法：短规则、硬约束、常用命令

.claude/
  skills/
    blog-writing/
      SKILL.md                  # 写作/发布流程（按需加载）
    release/
      SKILL.md                  # 发版流程（按需加载）

docs/
  README.md                     # 文档索引入口
  modules/
    joymew-screen.md            # 模块上下文
  decisions/
    adr-0001-url-base.md        # 决策记录（结构化）
  troubleshooting/
    vitepress-base.md           # 常见坑排查

src/
  moduleA/
    CLAUDE.md                   # 模块局部规则（只写必须遵守的约束）
```

---

## 6. 实操：我怎么在日常里使用它（让系统“活起来”）

你可以用两个小场景收尾：

### 场景 1：写文章

* 你手动调用 blog-writing skill
* 它按流程生成文章、更新索引、检查 base

### 场景 2：改某模块

* agent 进入 `src/moduleA/` 先读子目录 CLAUDE.md
* 需要理解背景时，去 `docs/modules/moduleA.md` 读上下文
* 做决策时，写 ADR

最后一句收束：

> **我的目标不是让 agent “记住更多”，而是让它“在正确的时候记住正确的东西”。**

---

# 你写博客时的“口吻技巧”（让文章更像踩坑总结而不是说明书）

* 用 1～2 个真实坑做引子（例如 base 前缀导致 URL 错）
* 每节用“结论句”收束（读者扫一遍也能带走）
* 少讲概念，多讲“放哪、为什么、怎么验证”

---

如果你愿意，我还可以把这篇博客直接写成一篇完整 Markdown（包含标题、开头故事、表格、目录树、结语），你只需要把仓库路径/模块名换成你自己的。
